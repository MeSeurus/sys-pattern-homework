# Домашнее задание по лекции "`Репликация и масштабирование. Часть 2`" - `Попов Всеволод`

### Задание 1

Опишите основные преимущества использования масштабирования методами:

активный master-сервер и пассивный репликационный slave-сервер;
master-сервер и несколько slave-серверов;
Дайте ответ в свободной форме.


Рассмотрим оба метода масштабирования отдельно, выделив ключевые преимущества каждого подхода и проведем небольшой сравнительный анализ с подведением итогов.

#### Метод 1: Активный master-сервер и пассивный репликационный slave-сервер

#### Преимущества:

Высокая производительность при операциях чтения. Запросы на чтение направляются на пассивные реплики, разгружая мастер-сервер. Это существенно увеличивает количество возможных одновременных запросов на чтение, делая систему быстрее для клиентов.

Просто реализуется и поддерживается. Мастер-сервер управляет всей обработкой транзакций и записей, а реплики служат только для поддержки чтения. Настройка и управление такой системой относительно просты.

Эффективная стратегия восстановления после сбоев. Если главный сервер выйдет из строя, возможен быстрый переход на реплику с минимальными потерями данных.

#### Недостатки:

Все операции записи идут через единственного мастера, создавая потенциальную "точку отказа."

Нет горизонтального масштабирования операций записи.


#### Метод 2: Active Master-сервер и несколько active Slave-серверов

#### Преимущества:

Горизонтальное масштабирование операций записи и чтения. Благодаря нескольким активным slave-серверам, запросы как на запись, так и на чтение могут быть направлены на разные узлы, увеличивая общую производительность системы.

Отсутствие единой точки отказа. Поскольку имеется несколько активно используемых серверов, выход из строя одного из них практически не влияет на работу всей системы.

Высокое использование вычислительных мощностей. За счет равномерного распределения нагрузки удается лучше задействовать аппаратные ресурсы всех серверов.

#### Недостатки:

Требует сложной координации и синхронизации данных между серверами, чтобы избежать противоречий и потерь данных.

Управление подобной системой технически сложнее и ресурсозатратнее.

#### Сравнительный анализ

Производительность операций чтения: Обе конфигурации обеспечивают высокий уровень производительности операций чтения. Тем не менее, второй метод выигрывает за счет большего количества серверов, участвующих в обработке запросов.

Производительность операций записи: Первый метод ограничен производительностью одного мастера, в то время как второй позволяет распараллелить процессы записи, достигая гораздо большей эффективности.

Надёжность и отказоустойчивость: Второй метод намного устойчивее к сбоям и выходу из строя отдельного сервера, так как отсутствует единственная точка отказа.

Стоимость эксплуатации и обслуживания: Первоначальные расходы и сложность поддержания первого метода ниже, так как он проще в реализации и управлении. Но в долгосрочной перспективе, при высоких нагрузках, второй метод оказывается выгоднее, предлагая лучшее соотношение цены и качества услуг.

#### Итог

Выбор подходящего метода масштабирования зависит от конкретной ситуации и уровня нагрузки на систему. Первый метод отлично подойдет для приложений с высоким уровнем операций чтения и умеренным количеством операций записи. Второй же лучше выбирать для крупных сервисов с большими объемами данных и необходимостью высокой отказоустойчивости.


### Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц:

пользователи,
книги,
магазины (столбцы произвольно).
Опишите принципы построения системы и их разграничение или разбивку между базами данных.

Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.

#### Ответ

Наша цель — создать такую систему, которая обеспечит оптимальное сочетание горизонтальной и вертикальной фрагментации (шардинга) данных, повысит производительность и снизит влияние одиночных точек отказа.

#### Принцип горизонтального шардинга:

Горизонтальный шардинг подразумевает деление данных одной таблицы на несколько частей, расположенных на разных физических устройствах. Вот пример принципов горизонтального шардинга для каждой таблицы:

	Таблица “Пользователи”:
	Разделим таблицу по региону проживания пользователей. Например, пользователи из Европы попадут в первый шард, из Америки — во второй, а из Азии — в третий.

	Таблица “Книги”:
	Можно поделить книги по жанрам литературы: классика — на один шард, фантастика — на другой, учебники — на третий.

	Таблица “Магазины”:
	Здесь применим аналогичное разделение магазинов по географии: Европа, Америка, Азия.

   P.S. С помощью такого шардирования легко проводить аналитические запросы при подведении квартальных результатов, сбора статистики и т.д.

#### Принцип вертикального шардинга:

Здесь данные каждой отдельной таблицы распределяются по отдельным физическим устройствам, что позволяет снизить нагрузку на каждое устройство индивидуально.

	Разделение таблиц по серверам:

Сервер 1: Таблица «Пользователи»
Сервер 2: Таблица «Книги»
Сервер 3: Таблица «Магазины»

Получаем следующую блок-схему:

![Скриншот-9](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/9.png)

#### Возможные режимы работы серверов:

	Write-heavy (режим интенсивных записей):
Реализуется на сервере #1 (таблица «Пользователи»). Чаще всего эта таблица подвергается большому количеству операций записи, поскольку постоянно создаются новые аккаунты и происходят изменения профилей пользователей.

	Read-intensive (режим интенсивного чтения):
Характерно для сервера #2 (таблица «Книги»). Эта таблица чаще читается пользователями при поиске книг, просмотре подробностей произведений и т.п., поэтому основное внимание уделяется оптимизации операций чтения.

	Hybrid (гибридный режим):
Применимо к серверу #3 (таблица «Магазины»). Данная таблица используется умеренно и для чтения, и для записи. Она играет важную роль в процессе заказов товаров и отслеживания запасов, что создает смешанный характер активности.

#### Подведение итогов:

Приведенный подход позволяет решить сразу несколько проблем:

	Оптимизация производительности: Деление данных между различными физическими устройствами снижает нагрузку на каждую единицу оборудования.
   
   Безопасность и отказоустойчивость: Даже если какой-то сервер выходит из строя, остальная инфраструктура продолжит поддерживать бизнес-процессы. (В теории, можно добавить еще несколько кластеров для большей отказоустойчивости)
   
   Расширяемость: Система легко расширяется добавлением новых серверов и увеличением числа шардов, если объемы данных растут.

Предложенная структура сочетает лучшие практики горизонтального и вертикального шардинга, давая сбалансированное решение проблемы масштабирования базы данных.